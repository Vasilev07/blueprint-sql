<div class="home-container">
  <!-- Search and Filter Section -->
  <div class="search-filter-section">
    <!-- Search Bar -->
    <div class="search-bar-wrapper">
      <p-iconField iconPosition="left" class="search-field">
        <p-inputIcon styleClass="pi pi-search"></p-inputIcon>
        <input 
          type="text" 
          pInputText 
          [(ngModel)]="searchTerm"
          (input)="onSearchChange()"
          placeholder="Search by location, age, interests..."
          class="search-input" />
      </p-iconField>
      <button 
        pButton 
        type="button" 
        icon="pi pi-refresh" 
        class="p-button-text p-button-rounded refresh-btn"
        (click)="onRefresh()"
        pTooltip="Refresh">
      </button>
    </div>

    <!-- Filter Buttons -->
    <div class="filter-pills">
      <button 
        *ngFor="let filter of filterOptions"
        pButton 
        type="button" 
        [label]="filter.label"
        class="filter-pill"
        [class.active]="currentFilter === filter.value"
        (click)="onFilterChange(filter.value)">
      </button>
    </div>

    <!-- Advanced Filters Section -->
    <div class="advanced-filters-section">
      <span class="filters-info">
        <i class="pi pi-filter"></i>
        Want more filtering options?
      </span>
      <a class="advanced-link" (click)="goToAdvancedSearch()">
        Open Advanced Filters
      </a>
    </div>
  </div>

  <!-- Sort Dropdown (Hidden by default, can be toggled) -->
  <div class="sort-section" *ngIf="false">
    <p-dropdown 
      [options]="sortOptions" 
      [(ngModel)]="currentSort"
      (onChange)="onSortChange($event)"
      optionLabel="label" 
      optionValue="value"
      placeholder="Sort by">
    </p-dropdown>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-container">
    <p-progressSpinner styleClass="w-4rem h-4rem"></p-progressSpinner>
    <p>Loading users...</p>
  </div>

  <!-- Empty State -->
  <div *ngIf="!isLoading && users.length === 0" class="empty-state">
    <i class="pi pi-users empty-icon"></i>
    <h3>No Users Found</h3>
    <p>Try changing your filters or check back later.</p>
    <button 
      pButton 
      type="button" 
      label="Reset Filters" 
      icon="pi pi-filter-slash"
      class="p-button-outlined"
      (click)="onFilterChange('all')">
    </button>
  </div>

  <!-- User Grid -->
  <div *ngIf="!isLoading && displayedUsers.length > 0" class="users-grid">
    <app-user-card 
      *ngFor="let user of displayedUsers; trackBy: trackByUserId"
      [user]="user"
      (chatClick)="onChatClick($event)"
      (cardClick)="onCardClick($event)">
    </app-user-card>
  </div>

  <!-- Loading More Indicator -->
  <div *ngIf="isLoadingMore" class="loading-more">
    <p-progressSpinner 
      styleClass="w-3rem h-3rem" 
      strokeWidth="4"
      animationDuration="1s">
    </p-progressSpinner>
    <p>Loading more users...</p>
  </div>

  <!-- End of Results -->
  <div *ngIf="!isLoading && !hasMoreData && displayedUsers.length > 0" class="end-of-results">
    <i class="pi pi-check-circle"></i>
    <p>You've reached the end! Showing all {{ displayedUsers.length }} users.</p>
  </div>
</div>

<!-- Toast Messages -->
<p-toast></p-toast>


